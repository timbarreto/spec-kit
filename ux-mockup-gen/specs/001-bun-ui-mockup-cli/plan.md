# Implementation Plan: Bun UI Mockup CLI

**Branch**: `001-bun-ui-mockup-cli` | **Date**: 2025-12-05 | **Spec**: ../spec.md
**Input**: Feature specification from `/specs/001-bun-ui-mockup-cli/spec.md`

## Summary

Build a Bun-based CLI that ingests a UI JSON (file or stdin), validates against a simplified component-tree schema, and generates a mockup image by calling the Gemini image generation API. Output image to a file; provide `--json` structured summary on stdout and keep logs on stderr.

## Technical Context

**Language/Version**: Bun (JavaScript/TypeScript) latest stable  
**Primary Dependencies**: Minimal — Bun runtime, `@google/generative-ai` SDK for Gemini  
**Storage**: N/A (local file I/O only)  
**Testing**: Bun test (`bun test`) with contract + unit + integration coverage  
**Target Platform**: Windows/macOS/Linux (Bun supported)  
**Project Type**: single CLI project  
**Performance Goals**: Typical mockup under 10s; streaming large JSON safely  
**Constraints**: Clean stdout; errors/logs → stderr; deterministic outputs given same inputs/options  
**Scale/Scope**: Single CLI tool with pluggable generator backends

## Constitution Check

The plan MUST demonstrate compliance with CLI principles:
- Text I/O contract: args/stdin → stdout; errors → stderr; exit codes.
- Single‑responsibility: each command scoped clearly with consistent flags.
- Test‑first: contract/unit/integration tests identified and scheduled.
- Discoverability: `--help` content and examples drafted/updated.
- Observability: logging strategy to `stderr`, no pollution of `stdout`.
- Configuration order: flags → env → project → user; overrides documented.
- Versioning impact: any breaking changes called out with migration notes.

## Project Structure

### Documentation (this feature)

```text
specs/001-bun-ui-mockup-cli/
├── plan.md
├── research.md
├── data-model.md
├── quickstart.md
├── contracts/
└── tasks.md (generated by /speckit.tasks)
```

### Source Code (repository root)

```text
src/
├── cli/
│   ├── index.ts            # entrypoint (arg/stdio handling)
│   ├── commands/
│   │   └── generate.ts     # single-responsibility: generate mockup
│   └── help.ts             # help text, examples
├── lib/
│   ├── schema.ts           # JSON schema validation
│   ├── parser.ts           # stdin/file streaming parser
│   ├── generators/
│   │   ├── gemini.ts       # primary backend
│   │   └── mock.ts         # mock backend for tests
│   └── output.ts           # image writing, format selection

tests/
├── contract/
│   └── generate.contract.test.ts
├── integration/
│   └── generate.integration.test.ts
└── unit/
    ├── schema.test.ts
    ├── parser.test.ts
    └── gemini.test.ts
```

**Structure Decision**: Single project layout optimized for CLI with clear separation of CLI surface, validation/parsing, generator backends, and tests.

## Complexity Tracking

| Violation | Why Needed | Simpler Alternative Rejected Because |
|-----------|------------|---------------------------------------|
| External SDK (`@google/generative-ai`) | Required to call Gemini safely | Raw HTTP adds auth/compat risk and more code
